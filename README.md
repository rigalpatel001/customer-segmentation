# ğŸ›ï¸ Advanced Customer Segmentation using RFM & Unsupervised Learning

## ğŸ“Œ Project Overview

This project performs **advanced customer segmentation** on retail transaction data using multiple unsupervised learning techniques:

* RFM Feature Engineering
* KMeans Clustering
* Hierarchical Clustering
* DBSCAN (Outlier Detection)
* Revenue Percentile Tiering
* Stability Testing
* Revenue Concentration Analysis
* PCA Visualization

The goal is to identify:

* High-value customers
* Revenue concentration risks
* Dormant customers
* Natural customer behavior patterns

---

# ğŸ“Š Dataset

**Dataset:** Online Retail Dataset (UK-based retail transactions)

* Transactions: 541,909
* Unique Customers: 4,338
* Features used:

  * InvoiceDate
  * Quantity
  * UnitPrice
  * CustomerID

After cleaning and aggregation, customers are represented using **RFM features**.

---

# ğŸ§  RFM Feature Engineering

Each customer is transformed into:

| Feature   | Meaning                  |
| --------- | ------------------------ |
| Recency   | Days since last purchase |
| Frequency | Number of transactions   |
| Monetary  | Total revenue generated  |

RFM reduces raw transactional data into customer-level behavioral representation.

---

# ğŸ” Clustering Techniques Used

## 1ï¸âƒ£ KMeans Clustering

* n_clusters = 3
* Silhouette Score â‰ˆ 0.585â€“0.594
* Stable across multiple random seeds

### Results:

* 14 extreme VIP customers
* 19% revenue generated by 0.3% customers

---

## 2ï¸âƒ£ Hierarchical Clustering

* Agglomerative clustering (n_clusters=3)
* Silhouette Score â‰ˆ 0.604

### Results:

* 64 premium customers
* 34% revenue concentration
* Deterministic clustering (no randomness)

---

## 3ï¸âƒ£ DBSCAN (Density-Based Clustering)

* eps = 1.2
* min_samples = 5

### Results:

* 32 outliers detected
* 27.6% of total revenue generated by 32 customers

DBSCAN automatically identified statistically extreme high-value customers without predefining cluster count.

---

# ğŸ“ˆ Revenue Concentration Analysis

Revenue distribution revealed:

| Segment              | % Customers | % Revenue |
| -------------------- | ----------- | --------- |
| Core Customers       | ~74%        | ~73%      |
| Dormant Customers    | ~25%        | ~7%       |
| High-Value Customers | <1%â€“1.5%    | 19â€“34%    |

This confirms strong Pareto behavior (revenue concentration risk).

---

# ğŸ· Revenue Percentile Tiering

In addition to clustering, deterministic business-tier segmentation was implemented:

* Top 1% â†’ Ultra VIP
* Top 5% â†’ Premium
* Remaining â†’ Regular

This provides business-aligned segmentation independent of clustering assumptions.

---

# ğŸ“Š Model Evaluation Techniques

The project includes:

* Silhouette Score
* Stability testing across random seeds
* Revenue distribution per cluster
* Cluster size analysis
* PCA 2D visualization
* Cross-method comparison

---

# ğŸš€ How to Run

### 1ï¸âƒ£ Create virtual environment

```bash
python -m venv venv
```

Activate:

Windows:

```bash
venv\Scripts\activate
```

Mac/Linux:

```bash
source venv/bin/activate
```

---

### 2ï¸âƒ£ Install dependencies

```bash
pip install -r requirements.txt
```

---

### 3ï¸âƒ£ Run pipeline

```bash
python -m scripts.run_pipeline
```

Outputs:

* Cluster summaries
* Revenue analysis
* Stability testing
* PCA visualization
* Processed dataset saved to:

```
data/processed/rfm_with_clusters.csv
```

---

# ğŸ“š Technologies Used

* Python
* Pandas
* NumPy
* Scikit-learn
* Matplotlib
* PCA
* KMeans
* Agglomerative Clustering
* DBSCAN

---

# ğŸ“Œ Author

Rigal Patel
MSc AI | Machine Learning Portfolio Project

